<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>üöÄ ‡∏•‡∏∑‡∏°‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</title>

<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter&display=swap" rel="stylesheet" />

<style>
  html {
    margin: 0;
    padding: 0;
    height: auto;   /* ‡πÄ‡∏ï‡πá‡∏° viewport ‡∏à‡∏£‡∏¥‡∏á‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
    width: auto;
    overflow-x: hidden;
  }

  body {
    margin: 0;
    padding: 0;
    height: 100dvh; /* ‡πÄ‡∏ï‡πá‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á viewport ‡∏à‡∏£‡∏¥‡∏á */
    display: flex;
    justify-content: center;
    align-items: center;
    overflow-y: auto; /* ‡πÉ‡∏´‡πâ pull-to-refresh ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô */
    overflow-x: hidden;
    font-family: 'Inter', sans-serif;
    background: radial-gradient(circle at top left, #0f172a, #020617 70%);
    color: #e0e0e0;
    -webkit-overflow-scrolling: touch;
  }
  
  .glass {
    background: rgba(255,255,255,0.05);
    backdrop-filter: blur(12px);
    border: 1px solid rgba(255,255,255,0.1);
  }
  .neon-border {
    border: 1px solid transparent;
    background-clip: padding-box;
    box-shadow: 0 0 12px rgba(59,130,246,0.6),
                0 0 24px rgba(168,85,247,0.5);
  }
  .pulse { animation: pulse 2s infinite; }
  @keyframes pulse { 0%,100%{opacity:1;} 50%{opacity:0.6;} }

  .error-border { border-color: #f87171 !important; }
  .group { position: relative; flex: 1; }
  .group input {
    width: 100%;
    padding: 12px 10px 8px 5px;
    border: none;
    border-bottom: 1px solid #666;
    background: transparent;
    color: #e0e0e0;
    outline: none;
  }
  .group label {
    position: absolute;
    left: 5px;
    top: 12px;
    color: #aaa;
    font-size: 16px;
    pointer-events: none;
    transition: 0.2s ease all;
  }
  .group input:focus ~ label,
  .group input:not(:placeholder-shown) ~ label {
    top: -10px;
    font-size: 14px;
    color: #a855f7;
  }
  input[type="email"]:focus {
    border-width: 2px;
    border-bottom-color: #a855f7;
  }
</style>
</head>
<body class="flex items-center justify-center h-screen px-4 sm:px-6 lg:px-8">

<div class="w-full max-w-sm sm:max-w-md glass neon-border rounded-2xl shadow-xl p-6 sm:p-8 relative">
  <div class="absolute -top-6 -right-6 w-20 h-20 sm:w-24 sm:h-24 bg-purple-600/30 rounded-full blur-3xl pulse"></div>

  <h2 class="text-3xl font-bold text-center mb-6 bg-gradient-to-r from-cyan-400 via-purple-400 to-blue-500 bg-clip-text text-transparent drop-shadow-lg">
    ‡∏•‡∏∑‡∏°‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
  </h2>

  <form method="POST" onsubmit="return validateForm(event);" class="space-y-4" novalidate>
    <!-- Email -->
    <div class="mb-4">
      <div class="group">
        <input type="text" id="email" name="identifier" placeholder=" " required
              value="{{ request.form.identifier if request.form.identifier else '' }}" />
        <label for="email">Username or Email</label>
      </div>
      <div id="email-error" class="text-sm mt-1 ml-1 {% if not flash %}hidden{% endif %} 
          {% if flash and flash.type == 'error' %}text-red-400{% elif flash and flash.type == 'success' %}text-green-400{% endif %}">
        {% if flash %}
          {{ flash.message }}
        {% endif %}
      </div>
    </div>

    <!-- Submit -->
    <input type="submit" value="‡∏™‡πà‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô"
           class="w-full py-2 bg-gradient-to-r from-blue-600 to-cyan-500 text-white font-semibold rounded-lg shadow-lg hover:opacity-80 transition cursor-pointer" />
  </form>

  <p class="text-sm flex justify-between mt-4">
    <a href="/login" class="text-purple-400 hover:underline">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</a>
    <a href="/register" class="text-purple-400 hover:underline">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</a>
  </p>
</div>

<script>
const emailInput = document.getElementById("email");
const emailError = document.getElementById("email-error");

function showError(inputElem, errorDiv, message){
  if(errorDiv){
    errorDiv.textContent = message;
    errorDiv.classList.remove("hidden");
    errorDiv.classList.add("text-red-400"); // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
    }
    inputElem.classList.add("error-border");
}
function hideError(inputElem, errorDiv){
  if(errorDiv){ errorDiv.classList.add("hidden"); }
  inputElem.classList.remove("error-border");
}

emailInput.addEventListener("input", ()=> hideError(emailInput,emailError));

async function validateForm(e){
  e.preventDefault();
  hideError(emailInput,emailError);

  const identifier = emailInput.value.trim();
  if(!identifier){
    showError(emailInput,emailError,"‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏µ‡πÄ‡∏°‡∏•");
    return false;
  }

  // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ @ ‚Üí ‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô email ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö regex
  if(identifier.includes("@")){
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if(!emailRegex.test(identifier)){
      showError(emailInput,emailError,"‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
      return false;
    }
  }

  // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà email ‚Üí ‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô username ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢
  e.target.submit();
}

</script>
</body>
</html>
